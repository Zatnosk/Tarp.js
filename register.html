<!DOCTYPE html>
<html>
<head>
	<title>Registration</title>
	<script src="http.js"></script>
</head>
<body>
	<a id="link" href="">link</a>
<script>
	var reqdata = {
		"name": "tent.js test",
		"description": "Testing of the tent.js library",
		"url": "https://github.com/Zatnosk/tentjs",
		"icon": "http://zatnosk.dk/img/profile.png",
		"redirect_uris": ["http://localhost/tent"],
		"scopes": {
			"write_posts" : "For testing the library",
			"read_posts": "For testing purposes"
		},
	}
	var registration_request = {
		"URL": "https://zatnosk.tent.is/tent/apps",
		"method": "POST",
		"headers":{
			"Content-Type":"application/vnd.tent.v0+json",
			"Accept":"application/vnd.tent.v0+json",
		},
		"body":JSON.stringify(reqdata)
	}
	console.log(registration_request)
	var response = http(registration_request)
	console.log(response)
	var data = JSON.parse(response.body)
	var redirect = "/oauth/authorize?"
		+"client_id="+data.id
		+"&redirect_uri="+data.redirect_uris[0]
		+"&scope=write_posts,read_posts"
		+"&response_type=code"
		+"&state=hest"
		+"&tent_post_types="+"https://tent.io/types/posts/status/v0.1.0"
	document.getElementById("link").setAttribute("href", "https://zatnosk.tent.is/tent"+redirect)
</script>
</body>
</html>